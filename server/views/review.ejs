<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="style.css" />
</head>
<body>


  <div class="kanjiHolder">
    <p id="kanji">shouldnotbehere</p>
  </div>

  <hr id="reviewSeparation">
  
  <div class="buttonHolder">
    <input type="button" id="incorrectButton" class="chooseButton" value="Incorrect" />
    <input type="button" id="correctButton" class="chooseButton" value="Correct" />
    <script type="text/javascript"" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script>
        var reviewList = <%-JSON.stringify(reviewList)%>

        document.getElementById("incorrectButton").addEventListener("click", incorrect, false)
        document.getElementById("correctButton").addEventListener("click", correct, false)

        const fourhours = 1000 * 60 * 60 * 4
        const eighthours = 1000 * 60 * 60 * 4
        const oneday = 1000 * 60 * 60 * 24
        const twodays = 1000 * 60 * 60 * 24 * 2
        const oneweek = 1000 * 60 * 60 * 24 * 7
        const twoweeks = 1000 * 60 * 60 * 24 * 7 * 2
        const fourmonths = 10512000000

        const stageTimesMap = new Map();
        stageTimesMap.set(0, fourhours);
        stageTimesMap.set(1, eighthours);
        stageTimesMap.set(2, oneday);
        stageTimesMap.set(3, twodays);
        stageTimesMap.set(4, oneweek);
        stageTimesMap.set(5, twoweeks);
        stageTimesMap.set(6, fourmonths);

        i = 0
        document.getElementById("kanji").innerHTML = reviewList[i].kanji

        function changeKanji() {
            if (reviewList[i+1] === "end") {
                $.ajax({
                    url: "/reviewEnd",
                    type: "POST",
                    data: {reviewList},
                })
                window.location.replace("/")
            }
            else {
                document.getElementById("kanji").innerHTML = reviewList[i].kanji
                i += 1
            }
        }
        function incorrect() {
            changeKanji()
        }
        function correct() {
          // set the next time to review
            currentTime = new Date().getTime();
                for (let i = 0; i < reviewList.length; i++) {
                    var nextTime = stageTimesMap.get(parseInt(reviewList[i].stage))
                    reviewList[i].nextReviewTime = currentTime + nextTime
                }
          //

            reviewList[i].stage += 1

            changeKanji()
        }
    </script>
  </div>
  
  <div class="infoHolder">
    <details class="dropdownInfo">
      <p>here</p>
    </details>
  </div>


</body>
</html>